<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeechRecognition API - a simple JavaScript experiment</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vina+Sans&display=swap" rel="stylesheet">

    <style>
        *{ margin: 0; padding: 0; box-sizing: border-box;}
        h1 {
            /* visibility: hidden; */
            opacity: 0;
        }
        #output {
            font-family: 'Vina Sans', sans-serif;
            font-size: 300px;
            line-height: 220px;
            position: absolute;
            top: 0px;
        }

        iframe{
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body>
    
    <h1>Speech Recognition TEST</h1>

    <p id="output">
        Click & Speak!
    </p>

    <script>
    
    var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition
    var SpeechRecognitionEvent = SpeechRecognitionEvent || webkitSpeechRecognitionEvent
    var recognition = new SpeechRecognition();
    
    recognition.continuous = false;
    recognition.lang = "en-US";
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    const diagnostic = document.querySelector("#output");
    const bg = document.querySelector("html");

    bg.onclick = () => {
        recognition.start();
        console.log("Ready to receive a color command.");
    };

    recognition.onresult = (event) => {
        const receivedText = event.results[0][0].transcript;
        diagnostic.textContent = `Message: ${receivedText}`;
        bg.style.backgroundColor = receivedText;
        recognition.stop();

        if(receivedText === "play video") {
            console.log("Video command was registered");
            let videoHTML = `<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/EceyCgxG1c8?si=ajB_0uZalpx8VbHH" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;
            diagnostic.innerHTML = videoHTML;
        }
        if(receivedText === "find me a hotel") {
            console.log("Travel command was registered");
            //top.location.href = "https://expedia.ca";
            window.open("https://expedia.ca", "_blank");
        }
    };


    </script>
</body>
</html>
